---
title: "Vim常用命令"
date: 2025-04-13
tags: ["Vim", "编辑器", "Linux", "命令行", "开发工具"]
---

# Vim 常用命令

Vim 是一个功能强大、高度可定制的文本编辑器，以其高效的编辑方式而闻名。作为程序员的必备工具之一，掌握 Vim 可以极大提高文本编辑效率。本文将介绍 Vim 的常用命令，从基础到进阶，帮助你熟练使用这一强大的编辑器。

## Vim 的基本模式

Vim 有几种基本工作模式，理解这些模式是掌握 Vim 的基础：

- **普通模式(Normal Mode)**: 默认模式，用于导航和操作文本
- **插入模式(Insert Mode)**: 用于输入文本
- **可视模式(Visual Mode)**: 用于选择文本块
- **命令行模式(Command Mode)**: 用于执行命令

在各种模式之间切换的命令：

```
i     -> 进入插入模式(在当前光标位置)
I     -> 进入插入模式(在当前行首)
a     -> 进入插入模式(在当前光标后)
A     -> 进入插入模式(在当前行尾)
o     -> 在当前行下方新建一行并进入插入模式
O     -> 在当前行上方新建一行并进入插入模式
Esc   -> 从任何模式返回普通模式
v     -> 进入可视模式(字符选择)
V     -> 进入可视模式(行选择)
Ctrl+v -> 进入可视模式(块选择)
:     -> 进入命令行模式
```

## 基本导航命令

在普通模式下，Vim 提供了丰富的导航命令，帮助你快速在文本中移动：

### 基本移动

```
h     -> 向左移动一个字符
j     -> 向下移动一行
k     -> 向上移动一行
l     -> 向右移动一个字符
```

### 单词级移动

```
w     -> 移动到下一个单词的开头
W     -> 移动到下一个以空格分隔的单词的开头
e     -> 移动到当前单词的结尾
E     -> 移动到当前以空格分隔的单词的结尾
b     -> 移动到前一个单词的开头
B     -> 移动到前一个以空格分隔的单词的开头
```

### 行级移动

```
0     -> 移动到行首(第一个字符)
^     -> 移动到行首(第一个非空白字符)
$     -> 移动到行尾
gg    -> 移动到文件第一行
G     -> 移动到文件最后一行
:n    -> 移动到第n行(例如:5移动到第5行)
```

### 屏幕级移动

```
Ctrl+f -> 向下翻页(Forward)
Ctrl+b -> 向上翻页(Backward)
Ctrl+d -> 向下翻半页
Ctrl+u -> 向上翻半页
H     -> 移动到屏幕顶部(High)
M     -> 移动到屏幕中央(Middle)
L     -> 移动到屏幕底部(Low)
zz    -> 将当前行置于屏幕中央
```

### 搜索移动

```
f{char} -> 在当前行向右查找字符{char}
F{char} -> 在当前行向左查找字符{char}
t{char} -> 移动到当前行中下一个字符{char}之前
T{char} -> 移动到当前行中上一个字符{char}之后
;     -> 重复上一次f, F, t, T搜索
,     -> 反向重复上一次f, F, t, T搜索
/{pattern} -> 向下搜索{pattern}
?{pattern} -> 向上搜索{pattern}
n     -> 重复上一次搜索(相同方向)
N     -> 重复上一次搜索(相反方向)
```

## 编辑命令

Vim 的强大之处在于其高效的文本编辑命令，这些命令通常在普通模式下执行：

### 基本编辑

```
x     -> 删除当前字符
r{char} -> 替换当前字符为{char}
R     -> 进入替换模式(覆盖现有文本)
s     -> 删除当前字符并进入插入模式
S     -> 删除整行并进入插入模式(同cc)
```

### 复制粘贴

```
yy 或 Y -> 复制当前行
y{motion} -> 复制指定范围文本(如yw复制一个单词)
p     -> 在光标后粘贴
P     -> 在光标前粘贴
dd    -> 剪切(删除)当前行
d{motion} -> 剪切(删除)指定范围文本(如dw删除一个单词)
```

### 撤销和重做

```
u     -> 撤销上一次更改
Ctrl+r -> 重做上一次撤销的更改
.     -> 重复上一次编辑命令
```

### 缩进和格式化

```
>>    -> 增加当前行缩进
<<    -> 减少当前行缩进
>G    -> 增加当前行到文件结尾的缩进
<G    -> 减少当前行到文件结尾的缩进
={motion} -> 自动格式化指定范围的代码
```

## 文本对象

Vim 的文本对象是一种高效选择和操作文本结构的方式：

```
i{object} -> 内部对象(inside)
a{object} -> 整个对象(around)

常用对象:
w - 单词
s - 句子
p - 段落
" - 双引号字符串
' - 单引号字符串
( 或 ) - 圆括号内
[ 或 ] - 方括号内
{ 或 } - 花括号内
< 或 > - 尖括号内
t - XML/HTML标签
```

例如：

```
ciw   -> 删除整个单词并进入插入模式(change inside word)
da"   -> 删除一个双引号字符串，包括引号(delete around quotes)
yi(   -> 复制圆括号内的内容(yank inside parentheses)
```

## 搜索和替换

Vim 提供了强大的搜索和替换功能：

```
/pattern        -> 向下搜索pattern
?pattern        -> 向上搜索pattern
:s/old/new/     -> 替换当前行第一个匹配的old为new
:s/old/new/g    -> 替换当前行所有匹配的old为new
:%s/old/new/g   -> 替换整个文件中所有匹配的old为new
:%s/old/new/gc  -> 替换整个文件中所有匹配的old为new，但每次替换前询问
```

### 高级替换

```
:s/old/new/gi   -> 忽略大小写的全局替换
:10,20s/old/new/g -> 替换第10到20行中所有匹配
:.,$s/old/new/g  -> 替换当前行到文件末尾的所有匹配
```

## 文件操作

基本的文件操作命令：

```
:e filename     -> 编辑新文件
:w              -> 保存文件
:w filename     -> 另存为新文件
:wq 或 :x 或 ZZ -> 保存并退出
:q              -> 退出(文件未修改)
:q!             -> 强制退出(不保存修改)
:wa             -> 保存所有打开的文件
:qa             -> 退出所有文件
```

## 窗口和标签页

Vim 支持同时编辑多个文件，通过窗口分割和标签页功能：

### 窗口分割

```
:split 或 :sp filename   -> 水平分割窗口
:vsplit 或 :vs filename  -> 垂直分割窗口
Ctrl+w s                 -> 水平分割当前窗口
Ctrl+w v                 -> 垂直分割当前窗口
Ctrl+w w                 -> 在窗口间循环切换
Ctrl+w h/j/k/l           -> 切换到左/下/上/右窗口
Ctrl+w H/J/K/L           -> 移动当前窗口到左/下/上/右侧
Ctrl+w +/-               -> 增加/减少窗口高度
Ctrl+w >/<               -> 增加/减少窗口宽度
Ctrl+w =                 -> 使所有窗口等宽等高
:close                   -> 关闭当前窗口
:only                    -> 关闭除当前窗口外的所有窗口
```

### 标签页

```
:tabnew filename         -> 在新标签页中打开文件
:tabn 或 gt              -> 切换到下一个标签页
:tabp 或 gT              -> 切换到上一个标签页
:tabfirst 或 :tabr       -> 切换到第一个标签页
:tablast                 -> 切换到最后一个标签页
:tabs                    -> 列出所有标签页
:tabclose 或 :tabc       -> 关闭当前标签页
:tabonly 或 :tabo        -> 关闭其他所有标签页
```

## 寄存器使用

Vim 的寄存器功能增强了复制粘贴操作：

```
"{register}y{motion}     -> 将指定文本复制到寄存器
"{register}p             -> 从寄存器粘贴

常用寄存器:
"" - 默认寄存器(匿名)
"0 - 最近一次复制操作
"1-"9 - 最近9次删除操作
"a-"z - 命名寄存器
"+ - 系统剪贴板(需要支持)
"* - 系统选择(需要支持)
```

## 宏录制

宏允许你录制一系列操作并重复执行：

```
q{register}              -> 开始录制宏到指定寄存器
q                        -> 停止录制宏
@{register}              -> 执行寄存器中的宏
@@                       -> 重复执行上一次执行的宏
{count}@{register}       -> 执行指定宏多次
```

## 标记(Marks)

标记允许你保存位置并快速返回：

```
m{a-zA-Z}                -> 设置标记
'{a-zA-Z}                -> 跳转到标记所在行
`{a-zA-Z}                -> 跳转到标记的确切位置
''.                      -> 跳转到上一次编辑的位置
:marks                   -> 显示所有标记
```

## 自定义你的 Vim

Vim 的强大之处还在于其高度可定制性：

```
:set number              -> 显示行号
:set nonumber            -> 不显示行号
:set relativenumber      -> 显示相对行号
:set tabstop=4           -> 设置Tab宽度为4个空格
:set expandtab           -> Tab自动转换为空格
:syntax on               -> 打开语法高亮
:colorscheme {name}      -> 改变配色方案

# 将常用设置保存到~/.vimrc文件中可永久生效
```

## Vim 插件管理

Vim 可以通过插件大幅增强功能，常用的插件管理器包括：

- Vundle
- vim-plug
- Pathogen

通过这些插件管理器，你可以安装代码补全、文件浏览、Git 集成等功能。

## 总结

Vim 是一个学习曲线陡峭但回报巨大的编辑器。通过持续练习，这些命令将成为你的肌肉记忆，大大提高文本编辑效率。建议从基本命令开始，逐步扩展你的 Vim 技能库。

记住 Vim 的哲学：

> 在 Vim 中，你不仅仅是在编辑文本，你是在与文本"交谈"

学习 Vim 的最佳方式是通过实践，可以使用`vimtutor`命令开始入门教程，或在线尝试[Vim Adventures](https://vim-adventures.com/)等游戏化学习工具。
